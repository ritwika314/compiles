\section{Koord Software Stack}
\label{sec:software}

\subsection{Runtime system}



To run a $\lgname$ program (hardware or simulation), the user has to provide a configuration file, with 
\begin{inparaenum}
\item the number of agents, 
\item in case of simulation, the initial positions of the agents and the length of the simulation and 
\item in case of hardware deployment their IP addresses, 
and the localization system.
\end{inparaenum} 

\subsection{Key environment assumptions} 


\subsubsection{Periodic event execution semantics}


\subsubsection{Shared variable implementation over message passing}


\subsubsection{Known set of participants}
\subsubsection{Portability and heterogeneity}


\subsection{Simulator}
\subsubsection{gazebo environment}
\subsubsection{car model}
\subsubsection{lidar}
\subsubsection{positioning}
\subsubsection{sampled sensing}
\subsubsection{synchronization issues}
 
\subsection{The Distributed Mapping Problem}
In this section, we introduce the distributed mapping problem that the $\lgname$ program shown in \reffig{mapapp} aims to solve. The key difference between distributed SLAM and this application is that we assume that the robots know their \emph{global coordinates} within the area of deployment. They are only attempting to map it. 
Informally, the problem requires a set of robots to collaboratively agree on positioning of static \emph{obstacles} within a given area $D$, which any robot should avoid while moving in $D$.

\subsubsection{Preliminaries}
We first set up the terminology and assumptions to discuss our approach to this problem. We currently assume that the only sensors available for sensing obstacle are LIDAR based, and the robots are constrained to move in a 2-D space.

The mapping problem is defined over a (\emph{bounded}) domain $D$. In our problem setup, we assume $D$ is a rectangle in $\mathbb{R}^2$ given by $[x_1,x_2]\times [y_1,y_2]$.

\begin{definition}
A \emph{grid} partitioning $G$ of a bounded domain $D$ is defined as $G:D \mapsto \mathbb{Z}\times\mathbb{Z}$, and it maps each point $(x,y)$ in $D$, to a \emph{square} $(i,j), i \in Z, j\in Z$.
\end{definition}

Given a domain $D\subset\mathbb{R}^2$, $G(D)$ refers to the set of $(i,j)$ squares that comprise all $(x,y)\in D$. This can be viewed as an embedding of a 2D-lattice in $\mathbb{R}^2$. Consider also, that there is a set of ground robots $S$ in which each robot can can detect obstacles at a minimum distance $d$, within a range of angles $\left[-\phi,\phi\right]$ from the current heading of the robot. We can then state the 2-d distributed mapping problem as follows. \begin{quote}
 {\em Given a set of robots $S$, a grid partitioning $G$ of a 2-d domain $D\subset \mathbb{R^2}$, construct an occupancy grid mapping $F: G(D) \mapsto \left\{1,0\right\}$ where $F(i,j) = 1$ represents that a grid square $(i,j)\in G(D)$ is at least partially occupied by an obstacle, $F(i,j) = 0$ represents $(i,j)$ is completely free of any obstacles.}
\end{quote}
\begin{definition}
Given a square $(i,j) \in G(D)$, its \emph{adjacent squares} are given by
$\mathit{Adj}_{(i,j)} = \left\{(i^\prime, j^\prime) \mid i^\prime \in \left\{i - 1, i +1\right\}, j^\prime in \left\{j-1,j+1\right\} \right\} \cap G(D)$ .\end{definition} 
We assume that initially, each robot starts from a grid square $(i,j)$ such that $\forall p \in \mathit{Adj}_{(i,j)}, F(p) = 0$ for any occupancy grid mapping $F$.  

\begin{definition}
A grid square $(i,j)\in G(D)$ is \emph{reachable} if  and $(i,j)$ doesn't contain an obstacle and either \begin{inparaenum}[(a)]
\item it is an initial position of a robot, or 
\item $\exists (i^\prime,j^\prime \in \mathit{Adj}_{(i,j)} $, such that $(i^\prime, j^\prime)$ is reachable. 
\end{inparaenum}

\end{definition}
Each robot has a \emph{heading angle}, which is the angle it is facing while having traversed to a reachable square. This heading angle determines the LIDAR scan area of the robot.  
\begin{definition}
A square $(i,j)$ is \emph{visible} from a reachable square if it is within the sensed LIDAR scan area of the heading angle of the robot from the current square.  
\end{definition}
A robot partially constructs a grid occupancy function by assigning values to visible squares.
\rg{We assume that {\em if an obstacle is sensed in a visible square, then the square does contain an obstacle}. The point of this presentation isn't dealing with the issue of potentially false positives while identifying an obstacle.} 

We first discuss a modified version of the 2-d distributed mapping problem, where we construct a grid occupancy function $F: G(D) \mapsto \left\{1,0,-1\right\}$, where $F(i,j) = -1$ means that $(i,j)$ hasn't been visited or is visible from a reachable square. There may be various properties of the obstacles, and the initial conditions of the robots under which it may not be possible to construct a known grid occupancy (0 or 1) for certain grid squares. We propose the following notion of soundness for an algorithm which aims to the 2-d mapping problem:
l{\em If there is an obstacle in a square that can be visible from a reachable square given any heading angle, then it will be detected. }


\subsection{External (Library) Functions}
