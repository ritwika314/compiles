using Lidar $\label{lidardef}$
    sensors:
       ScanStamped[] ldata

using Motion $\label{moddef}$
    sensors:
        Pos pos,
        PosStamped[] trace,
        bool reached
    actuators:
        Pos target

allwrite:$\label{awvar}$
    GridMap globalMap

#$\mathit{omitting\ initialization}$

local:
   GridMap map
   bool newpoint $=$ True

NewPoint:$\label{newpt}$
  pre newpoint
  eff : map $=$ map $\oplus$ globalMap
        Motion.target $=$ pickFrontierPos(
                              localMap, Motion.pos)
        newpoint $=$ False

LUpdate:$\label{lup}$
   pre not (newpoint || Motion.reached )
   eff : pscan $=$ tSync(Motion.trace, Lidar.ldata)
         for pos, scan in pscan:
             map $=$ map $\oplus$ scanToMap(pos, scan)

GUpdate: $\label{gup}$
  pre Motion.reached
  eff: atomic:
           globalMap $=$ globalMap $\oplus$ map
        newpoint $=$ True