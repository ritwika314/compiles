Platoon(pid)

using Motion 
    sensors:`
       pos psn
    actuators:
       float xvel
       
allread:
   pos mypos = Motion.psn

local:
   float safedist = 5.0
   float dist 
   int j = 0 
   int mode = 0
   
   
SetVelocity:
  pre True
  eff :
     if (pid == numBots - 1) :
        if mode == 0:
            if j $\geq$ 100:
                 mode = 1
        else:
            if j $\leq$ 0:
                mode = 0
                
        if mode == 0:
            Motion.xvel = 2
            j = j + 1
          
        if mode == 1:
            Motion.xvel = 0.01
            j = j - 1
     else:
        dist = pos[pid + 1].x - pos[pid].x
        if (dist >= safedist):
            Motion.xvel = 2.0
        else:
            Motion.xvel = 1.0
    mypos[pid] = Motion.psn

